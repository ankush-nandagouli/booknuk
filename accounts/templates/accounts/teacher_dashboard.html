{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="container mx-auto px-4 py-6">

  <h2 class="text-3xl font-bold text-indigo-700 mb-6 text-center">
     Teacher Dashboard
  </h2>

  <!-- Stats Chart -->
  <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-5 mb-8">
    <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200 mb-4">Books & Student Stats</h3>
    <canvas id="dashboardChart" class="w-full h-64"></canvas>
  </div>

  <!-- Dashboard Cards -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

    <!-- Card 1: Students & Books -->
    <div class="bg-indigo-100 hover:bg-indigo-200 rounded-lg shadow p-5 transition">
      <h3 class="text-gray-700 font-semibold mb-4">Students & Books</h3>
      <div class="grid gap-3">
        <div class="flex justify-between items-center">
          <span>Total Students</span>
          <span class="font-bold">{{ total_students }}</span>
        </div>
        <div class="flex justify-between items-center">
          <span>Active Students</span>
          <span class="font-bold text-green-600">{{ active_students }}</span>
        </div>
        <div class="flex justify-between items-center">
          <span>Overdue Books</span>
          <span class="font-bold text-red-600">{{ overdue_books_count }}</span>
        </div>
        <a href="{% url 'faculty:teacher_issue_book' %}" class="mt-3 block text-center bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 rounded">
          Issue Book
        </a>
      </div>
    </div>

    <!-- Card 2: Student Management -->
    <div class="bg-green-100 hover:bg-green-200 rounded-lg shadow p-5 transition">
      <h3 class="text-gray-700 font-semibold mb-4">Student Management</h3>
        <a href="{% url 'faculty:student_list' %}" class="block bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 rounded text-center">
          View Profiles & Suspend Students
        </a>

    </div>

    <!-- Card 3: Notifications -->
    <div class="bg-purple-100 hover:bg-purple-200 rounded-lg shadow p-5 transition">
      <h3 class="text-gray-700 font-semibold mb-4">Notifications</h3>
      <span class="text-red">Send Notification to all registered students at once through e-mail.</span>
      <a href="{% url 'faculty:send_notification' %}" class="block bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 rounded text-center">
        Send Notifications
      </a>
    </div>

  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('dashboardChart').getContext('2d');
const dashboardChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['Total Students', 'Active Students', 'Overdue Books', 'Issued Books'],
        datasets: [{
            label: 'Count',
            data: [{{ total_students }}, {{ active_students }}, {{ overdue_books_count }}, {{ issued_books_count }}],
            backgroundColor: [
                'rgba(99, 102, 241, 0.7)',
                'rgba(16, 185, 129, 0.7)',
                'rgba(239, 68, 68, 0.7)',
                'rgba(234, 179, 8, 0.7)'
            ],
            borderColor: [
                'rgba(99, 102, 241, 1)',
                'rgba(16, 185, 129, 1)',
                'rgba(239, 68, 68, 1)',
                'rgba(234, 179, 8, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { display: false },
            tooltip: { enabled: true }
        },
        scales: {
            y: { beginAtZero: true, ticks: { stepSize: 1 } }
        }
    }
});
</script>
{% endblock %}
